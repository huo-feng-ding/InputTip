arrJoin(arr, separator := ",") {
    res := ""
    for i, v in arr {
        res .= i = arr.Length ? v : v separator
    }
    return res
}

hasChildDir(path) {
    Loop Files path "\*", "D" {
        return A_Index
    }
}

isMouseOver(WinTitle) {
    MouseGetPos , , &Win
    return WinExist(WinTitle " ahk_id " Win)
}

replaceEnvVariables(str) {
    while RegExMatch(str, "%\w+%", &match) {
        env := match[]
        envValue := EnvGet(StrReplace(env, "%", ""))
        str := StrReplace(str, env, envValue)
    }
    return str
}

/**
 * 获取到屏幕信息
 * @returns {Array} 一个数组 [{num:1,left:0,top:0,right:0,bottom:0}]
 */
getScreenInfo() {
    list := []
    MonitorCount := MonitorGetCount()
    MonitorPrimary := MonitorGetPrimary()
    Loop MonitorCount
    {
        MonitorGet A_Index, &L, &T, &R, &B
        MonitorGetWorkArea A_Index, &WL, &WT, &WR, &WB
        list.Push({
            main: MonitorPrimary,
            count: MonitorCount,
            num: A_Index,
            left: L,
            top: T,
            right: R,
            bottom: B
        })
    }
    return list
}
isWhichScreen(screenList) {
    MouseGetPos(&x, &y)
    for v in screenList {
        if (x >= v.left && x <= v.right && y >= v.top && y <= v.bottom) {
            return v
        }
    }
}

; 从字符串中提取出数字，可以带负号
returnNumber(value) {
    if (value = "" || !(value ~= "\d")) {
        return 0
    }
    RegExMatch(value, "(-?\d+)", &numbers)
    return numbers[1]
}
